<!-- #BeginTemplate "templatesubdir.dwt" -->
<!doctype html public "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<!-- #BeginEditable "TITLE" -->
<title>Der neue Personalausweis</title>
<!-- #EndEditable -->
<link rel=stylesheet type="text/css" href="../style.css">
<meta name="author" content="Andreas Schwier">
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="750" align="center">
  <tr>
    <td height="80" colspan="5" class="pb"><div align="left"><a href="http://www.cardcontact.de"><img src="../banner.jpg" width="750" height="80" border="0"></a></div></td>
  </tr>
  <tr height="20">
  </tr>
  <tr>
    <td width="130" valign="top" align="left">
    <br>
    <p><b>Script Collection</b></p>
    <a href="../index.html">Home</a><br>
    <a href="http://www.openscdp.org/scripts/download.html">Download</a><br>
    <br>
    <a href="../cardsim/index.html">Card Simulation</a><br>
    <a href="../cardsim/index.html">Testing</a><br>
    <br>
    <a href="../eGK/index.html">German eGK</a><br>
    <a href="../HPC/index.html">German HPC</a><br>
    <a href="../kvk/index.html">German KVK</a><br><br>
    <a href="../icao/index.html">ICAO MRTD</a><br>
    <a href="../gp/index.html">GP Card</a><br>
    <a href="../musclecard/index.html">MuscleCard</a><br>
    <a href="../pkcs15/index.html">PKCS#15 Card</a><br>
    <a href="../emv/index.html">EMV</a><br>
    <br>
    <a href="../tutorial/index.html">Tutorial</a><br>
    <br>
    <a href="http://www.openscdp.org">OpenSCDP</a><br>
    <a href="http://www.cardcontact.de/company/contact.html">Contact</a><br>
    </td>
    <td width="630" align="left">
    <br/>
<!-- #BeginEditable "BODY" -->
<h1>Der Weg hinein</h1>
<p>Die auf dem Chip gespeicherten Daten sind vor unberechtigtem Zugriff geschützt. Im Umkehrschluß muss ein berechtigtes
   Terminal also erst einmal nachweisen, dass es auch tatsächlich berechtigt ist. Dazu ist in der TR-03110 das sogenannte
   Extended Access Control (EAC) Protokoll definiert worden. Die Version 2 ist auf den nPA zugeschnitten, die Version 1
   wurde seinerzeit für den Reisepass mit biometrischen Merkmalen konzipiert.</p>
<p>Das EAC Protokoll erfordert vor dem Zugriff auf die eigentlichen Daten drei Protokollschritte</p>
<ol>
<li>Password Authenticated Connection Establishment (PACE)</li>
<li>Terminal Authentication (TA)</li>
<li>Chip Authentication (CA)</li>
</ol>
<p>PACE baut auf Basis eines gemeinsamen Geheimnisses einen kryptographisch gesicherten Übertragungskanal zum Chip auf.
   Das gemeinsame Geheimnis ist dabei die Card Access Number (CAN), die eID-PIN, die PUK oder die MRZ. Die CAN sowie die
   MRZ sind auf dem nPA aufgedruckt, sie sind also nur insofern ein Geheimnis, als das ein Angreifer auf der Funkschnittstelle
   ohne Blick auf den Ausweis diese Daten nicht kennt.</p>
<p>Wurde das PACE Protokoll erfolgreich durchlaufen, dann ist zwischen Chip und Terminal ein gesicherter Übertragungskanal
   etabliert, über den sich anschließend das Terminal gegenüber dem Chip authentifiziert. Hierfür benötigt das Terminal einen privaten
   Signaturschlüssel und eine dafür ausgestellte Kette von Zertifikaten. Diese Kette muss sich auf einen im nPA 
   gespeicherten Vertrauensanker zurückführen lassen. Das letzte Zertifikat dieser Kette, also das Zertifikat des
   Terminals enthält dabei eine Angabe, welche Datenfelder durch dieses Terminal ausgelesen werden dürfen, bzw. Funktionen
   das Terminal ausführen darf.</p>
<p>Eine erfolgreiche Terminal Authentifizierung ist Voraussetzung für den letzten Schritt des EAC Protokolls. Bei der
   Chip Authentifizierung prüft das Terminal die Echtheit des Ausweises. Gleichzeitig wird dabei ein neuer gesicherter
   Übertragungskanal etabliert, der dann für alle folgenden Zugriffe benutzt wird.</p>
<p>Der sichere Kanal bleibt erhalten, bis der nPA vom Kartenleser genommen wird, oder der Kartenleser die Verbindung zum
   Ausweis zurücksetzt.</p>
   
<p><a href="npa-setup.html">"Preparing the stage"...</a></p>
<!-- #EndEditable -->
<br>
<p class="copyright">&copy; Copyright 2003 - 2010 <a href="http://www.cardcontact.de">CardContact</a>
Software & System Consulting, Minden, Germany</p>
    </td>
  </tr>
</table>
</body>
</html><!-- #EndTemplate -->